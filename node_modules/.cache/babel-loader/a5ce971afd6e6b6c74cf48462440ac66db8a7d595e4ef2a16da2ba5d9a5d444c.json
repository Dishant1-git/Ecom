{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ranag\\\\OneDrive\\\\Desktop\\\\reactprojectstudent\\\\src\\\\productdetails.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport Swal from 'sweetalert2';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Productdetails = () => {\n  _s();\n  const [product, setProduct] = useState({});\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  const [params] = useSearchParams();\n  const productId = params.get(\"id\");\n  const {\n    Loggedin,\n    email,\n    userid,\n    username\n  } = useSelector(state => state.userslice);\n  useEffect(() => {\n    fetchProductDetails();\n  }, []);\n  const fetchProductDetails = async () => {\n    try {\n      const res = await fetch(`http://localhost:9000/api/pdetails/${productId}`);\n      const result = await res.json();\n      if (result.statuscode === 1) {\n        setProduct(result.dd);\n      } else throw new Error(\"Product not found\");\n    } catch (err) {\n      Swal.fire(\"Error\", err.message, \"error\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  const addToCart = async () => {\n    if (!Loggedin) {\n      Swal.fire(\"Login Required\", \"Please login to add to cart\", \"warning\");\n      return navigate(`/login?pid=${productId}`);\n    }\n    const quantity = 1;\n    const totalprice = product.pprice * quantity;\n    const checkRes = await fetch(`http://localhost:9000/api/checkcart?email=${email}&productid=${productId}`);\n    const checkResult = await checkRes.json();\n    if (checkResult.statuscode === 2) {\n      // Update\n      await fetch(\"http://localhost:9000/api/updatecart\", {\n        method: \"PUT\",\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          email,\n          productid: productId,\n          newQuantity: checkResult.existingQuantity + quantity,\n          productprice: product.pprice\n        })\n      });\n      Swal.fire(\"Updated\", \"Cart quantity updated\", \"success\");\n    } else {\n      // Add\n      const addRes = await fetch(\"http://localhost:9000/api/addcart\", {\n        method: \"POST\",\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          userid,\n          username,\n          email,\n          productid: productId,\n          productname: product.pname,\n          productprice: product.pprice,\n          pq: quantity,\n          productimage: product.pimg,\n          productdescription: product.pdescription,\n          totalprice\n        })\n      });\n      const addResult = await addRes.json();\n      if (addResult.statuscode === 1) {\n        Swal.fire(\"Added\", \"Product added to cart\", \"success\");\n      } else {\n        Swal.fire(\"Error\", \"Failed to add product\", \"error\");\n      }\n    }\n    navigate(\"/addtocart\");\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: product.pname\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      src: `/uploads/${product.pimg}`,\n      alt: product.pname,\n      style: {\n        width: \"300px\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: product.pdescription\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Price: \\u20B9\", product.pprice]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Quantity Left: \", product.pq]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-primary\",\n      onClick: addToCart,\n      children: \"Add to Cart\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 5\n  }, this);\n};\n_s(Productdetails, \"dZanQv05lC1jqsUihfFmU94pAsI=\", false, function () {\n  return [useNavigate, useSearchParams, useSelector];\n});\n_c = Productdetails;\nexport default Productdetails;\nvar _c;\n$RefreshReg$(_c, \"Productdetails\");","map":{"version":3,"names":["React","useEffect","useState","useSelector","useNavigate","useSearchParams","Swal","jsxDEV","_jsxDEV","Productdetails","_s","product","setProduct","loading","setLoading","navigate","params","productId","get","Loggedin","email","userid","username","state","userslice","fetchProductDetails","res","fetch","result","json","statuscode","dd","Error","err","fire","message","addToCart","quantity","totalprice","pprice","checkRes","checkResult","method","headers","body","JSON","stringify","productid","newQuantity","existingQuantity","productprice","addRes","productname","pname","pq","productimage","pimg","productdescription","pdescription","addResult","children","fileName","_jsxFileName","lineNumber","columnNumber","className","src","alt","style","width","onClick","_c","$RefreshReg$"],"sources":["C:/Users/ranag/OneDrive/Desktop/reactprojectstudent/src/productdetails.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { useNavigate, useSearchParams } from 'react-router-dom';\r\nimport Swal from 'sweetalert2';\r\n\r\nconst Productdetails = () => {\r\n  const [product, setProduct] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n  const navigate = useNavigate();\r\n  const [params] = useSearchParams();\r\n  const productId = params.get(\"id\");\r\n\r\n  const { Loggedin, email, userid, username } = useSelector((state) => state.userslice);\r\n\r\n  useEffect(() => {\r\n    fetchProductDetails();\r\n  }, []);\r\n\r\n  const fetchProductDetails = async () => {\r\n    try {\r\n      const res = await fetch(`http://localhost:9000/api/pdetails/${productId}`);\r\n      const result = await res.json();\r\n      if (result.statuscode === 1) {\r\n        setProduct(result.dd);\r\n      } else throw new Error(\"Product not found\");\r\n    } catch (err) {\r\n      Swal.fire(\"Error\", err.message, \"error\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const addToCart = async () => {\r\n    if (!Loggedin) {\r\n      Swal.fire(\"Login Required\", \"Please login to add to cart\", \"warning\");\r\n      return navigate(`/login?pid=${productId}`);\r\n    }\r\n\r\n    const quantity = 1;\r\n    const totalprice = product.pprice * quantity;\r\n\r\n    const checkRes = await fetch(`http://localhost:9000/api/checkcart?email=${email}&productid=${productId}`);\r\n    const checkResult = await checkRes.json();\r\n\r\n    if (checkResult.statuscode === 2) {\r\n      // Update\r\n      await fetch(\"http://localhost:9000/api/updatecart\", {\r\n        method: \"PUT\",\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          email,\r\n          productid: productId,\r\n          newQuantity: checkResult.existingQuantity + quantity,\r\n          productprice: product.pprice\r\n        })\r\n      });\r\n      Swal.fire(\"Updated\", \"Cart quantity updated\", \"success\");\r\n    } else {\r\n      // Add\r\n      const addRes = await fetch(\"http://localhost:9000/api/addcart\", {\r\n        method: \"POST\",\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          userid,\r\n          username,\r\n          email,\r\n          productid: productId,\r\n          productname: product.pname,\r\n          productprice: product.pprice,\r\n          pq: quantity,\r\n          productimage: product.pimg,\r\n          productdescription: product.pdescription,\r\n          totalprice\r\n        })\r\n      });\r\n\r\n      const addResult = await addRes.json();\r\n      if (addResult.statuscode === 1) {\r\n        Swal.fire(\"Added\", \"Product added to cart\", \"success\");\r\n      } else {\r\n        Swal.fire(\"Error\", \"Failed to add product\", \"error\");\r\n      }\r\n    }\r\n\r\n    navigate(\"/addtocart\");\r\n  };\r\n\r\n  if (loading) return <div>Loading...</div>;\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <h2>{product.pname}</h2>\r\n      <img src={`/uploads/${product.pimg}`} alt={product.pname} style={{ width: \"300px\" }} />\r\n      <p>{product.pdescription}</p>\r\n      <p>Price: â‚¹{product.pprice}</p>\r\n      <p>Quantity Left: {product.pq}</p>\r\n      <button className=\"btn btn-primary\" onClick={addToCart}>Add to Cart</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Productdetails;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}